<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=gb2312">
    <title>PUREJS版本cinvccbar-全功能</title>
	<meta http-equiv="X-UA-Compatible" content="IE=8" />
	<link rel="stylesheet" type="text/css" href="scripts/ui/css/style.css">

	<link rel="stylesheet" type="text/css" href="jquery-easyui-1.4/themes/default/easyui.css">
	<link rel="stylesheet" type="text/css" href="jquery-easyui-1.4/themes/icon.css">
	<script src="jquery-easyui-1.4/jquery.min.js" type="text/javascript"></script>
	<script src="jquery-easyui-1.4/jquery.easyui.min.js" type="text/javascript"></script>


	<script src="scripts/jssip.min.js" type="text/javascript"></script>
	<script src="scripts/jcinvccbar-pure.min.js" type="text/javascript"></script>

	<script src="scripts/ui/jbardisplay.js" type="text/javascript"></script>

	<script src="jbarextent.js" type="text/javascript"></script>
<!--
	<script src="https://cdn.bootcss.com/vConsole/3.3.4/vconsole.min.js"></script>
-->

	<style> BODY { FONT-FAMILY: "Verdana"; FONT-SIZE: 12px; SCROLLBAR-HIGHLIGHT-COLOR: #f5f9ff; SCROLLBAR-SHADOW-COLOR: #828282; SCROLLBAR-3DLIGHT-COLOR: #828282; SCROLLBAR-ARROW-COLOR: #797979; SCROLLBAR-TRACK-COLOR: #ffffff; SCROLLBAR-FACE-COLOR: #66b7ef; SCROLLBAR-DARKSHADOW-COLOR: #ffffff }
	</style>
 </head>
<body onload="window_onload();" >
        <br>
        <br>
		<DIV id="rtpStatics" style="display: block">
		<DIV style='position:absolute;border:0px solid #ff3900; left:1252px;top:22px;'>
			<span id="Tdelay" > 延时:0ms </span>
		</DIV>
		<div style="position:absolute;border:0px solid #ff00ff;left:1330px; top:15px;">
			<ul id="TQuality"><li></li><li></li><li></li><li></li><li></li></ul>
		</div>
		</DIV>
        <DIV style='position:absolute;border:0px solid #ff3900; left:10px;top:60px;'>
        服务器&nbsp;&nbsp;&nbsp;: <input type="text" id="mainIP" value="111.204.26.22"size="20"  /><br>
		端口号&nbsp;&nbsp;&nbsp;: <input type="text" id="mainPort" value="5049" size="20"  />&nbsp;&nbsp;&nbsp;<br>
        集团号&nbsp;&nbsp;&nbsp;: <input type="text" id="vccID" size="20" value="100001"  /> <br>
		工&nbsp;&nbsp;&nbsp;号&nbsp;&nbsp;&nbsp;: <input type="text" id="agentID" value="1006" size="20"  /><br>
		座席密码: <input type="text" id="agnetPassword" value="123abc" size="20"  /><br>
		sip密码&nbsp;&nbsp;: <input type="text" id="sipPassword" value="" size="20"  /><br>
		sipxpath: <input type="text" id="sipXPath" value="acd" size="20"  /><br>

		</DIV>
		<DIV style='position:absolute;border:0px solid #000000; left:287px;top:180px;'>
			目标参数:
			<INPUT type="text" id="DestNum" NAME="DestNum" size="40" title="变量名称:DestNum"><br>
			附加参数:
			<INPUT type="text" id="DestNum2" NAME="DestNum2"  size="40"  title="变量名称:DestNum2" >
		</DIV>
		<DIV style='position:absolute;border:1px solid #000000; left:287px;top:60px;'>
               <input id='btncmd1' type="button" onclick='funChangePad(1);' style="background:#f5f9ff; border:0 " value="基本命令"/>
               <input id='btncmd2' type="button" onclick='funChangePad(2);' style="background:#f5f9ff; border:0 " value="基本状态"/>
    		   <input id='btncmd7' type="button" onclick='funChangePad(7);' style="background:#f5f9ff; border:0 " value="基本状态2"/>
               <input id='btncmd3' type="button" onclick='funChangePad(3);' style="background:#f5f9ff; border:0 " value="呼叫命令"/>
               <input id='btncmd4' type="button" onclick='funChangePad(4);' style="background:#f5f9ff; border:0 " value="质检命令"/>
               <input id='btncmd5' type="button" onclick='funChangePad(5);' style="background:#f5f9ff; border:0 " value="监控命令"/>
		</DIV>
		<div id ="divPad0" style="position:absolute;border:0px solid #4A9DF9;left:10px;top:226px;"  >
			<br>
			AppType:
			<SELECT ID="oAppType" NAME="AppTypes" onchange="application.oJVccBar.SetAttribute('AppType',parseInt(oAppType.options[oAppType.options.selectedIndex].value));">
				<OPTION VALUE="0" SELECTED>Agent
				<OPTION VALUE="1">Monitor
				<OPTION VALUE="2" >Agent+Monitor
			</SELECT>
			<br>
			ProtocolType:
			<SELECT ID="oProtocolType" NAME="ProtocolTypes" onchange="application.oJVccBar.SetAttribute('ProtocolType',parseInt(oProtocolType.options[oProtocolType.options.selectedIndex].value));">
				<OPTION VALUE="0">http
				<OPTION VALUE="1"  SELECTED>https
			</SELECT>
			<br>
			TransportType:
			<SELECT ID="oTransportType" NAME="TransportType" onchange="application.oJVccBar.SetAttribute('TransportType',parseInt(oTransportType.options[oTransportType.options.selectedIndex].value));">
				<OPTION VALUE="0" SELECTED>websocket
				<OPTION VALUE="1" >polling
			</SELECT>
			<br>
			视频内容:
			<SELECT ID="oVideoSource" NAME="oVideoSource" >
				<OPTION VALUE="camera" SELECTED>摄像头
				<OPTION VALUE="watermark" >水印
				<OPTION VALUE="background" >背景图片
			</SELECT>
			<br>
			摄像头:
			<SELECT ID="oCameraDevices" NAME="oCameraDevices" >
			</SELECT>
			<br>
			麦克风:
			<SELECT ID="oAudioInputDevices" NAME="oAudioInputDevices" onchange="SetCameraDevices();">
			</SELECT>
			<br>
			扬声器:
			<SELECT ID="oAudioOutputDevices" NAME="oAudioOutputDevices" onchange="SetCameraDevices();">
			</SELECT>
			<br>
			分辨率宽度: <input type="text"  id="resolutionWidth" value="480" size="8"  />
			<br>
			分辨率高度: <input type="text" id="resolutionHeight" value="640" size="8"  />
			<br>
			带宽(kb): <input type="text" id="resolutionBandWidth" value="1000" size="8"  />
			<br>
			帧率: <input type="text" id="resolutionFrame" value="15" size="8"  />
			<br>
			<label><input id="log_rtpStatics" type="checkbox" value="0" />音视频统计信息 </label>
			<br>
			<input type="button" onclick="funConfigurate();" value="视频参数设置" title="执行清空日志;" />

			<br>
		</div>
		<div id ="divPad1" style="position:absolute;border:0px solid #4A9DF9;left:287px;top:70px; display:none;"  >
                <br>
                <input id='btnInitial' type="button" onclick='funInitial();'  value="初始化" title="执行方法:Initial()" />
                <input id='btnUnInitial' type="button" onclick='application.oJVccBar.UnInitial();' value="注销" title="执行方法:UnInitial()" />
                <input id='btnSerialBtn' type="button" onclick='funSerialBtn();' value="界面设置" title="执行方法:SerialBtn(DestNum,DestNum2) " />
                <input id='btnGetBtnStatus' type="button" onclick='alert(application.oJVccBar.GetBtnStatus(DestNum.value));' value="可用电话按钮" title="执行方法:GetBtnStatus(DestNum) " />
			    <input id='btnEmpty' type="button" onclick="emptyLog();" value="清空日志" title="执行清空日志;" />
                <br>
				<input id="btnConfigurate" onclick="funConfigurate();" type="button" value="设置参数" title="执行方法:Configurate(DestNum.value)">
				<input id="btnGetConfiguration" onclick="alert(application.oJVccBar.GetConfiguration());" type="button" value="得到参数" title="执行方法:GetConfiguration()">
                <input id='btnGetVersion' type="button" onclick='alert(application.oJVccBar.GetVersion());' value="版本" title="执行:GetVersion(),得到版本号" />
                <input id='btnCheckUrl' type="button" onclick="checknewhttpsUrl();" value="检查httpsUrl" title="检查httpsUrl;" />
                <input type="button" onclick="openPaletteWrapper()" value="打开共享页面" title="打开共享页面"/>
                <br><br>
					日志级别:<label><input id="log_error" type="checkbox" value="0" onclick="SetLogType();"/>致命错误 </label>
					<label><input id="log_warn" type="checkbox" value="0" onclick="SetLogType();"/>警告信息 </label>
					<label><input id="log_info" type="checkbox" value="0" onclick="SetLogType();"/>提示消息 </label>
					<label><input id="log_debug" type="checkbox" value="0" onclick="SetLogType();"/>调试信息</label>
					<label><input id="log_protocal" type="checkbox" value="0" onclick="SetLogType();"/>协议信息 </label>

					<label><input id="log_console" type="checkbox" value="0" onclick="SetLogType();"/>sip日志 </label>
                <br>
		</div>	
	    <div id ="divPad2" style="position:absolute;border:0px solid #ff00ff;left:287px;top:70px; display:none;"  >
                <br>
			    <input id="btnSetBusy" onclick="funBaseMethod('SetBusy');" type="button" value="置忙" title="执行方法:SetBusy(DestNum.value)">
			    <input id="btnSetIdle" onclick="funBaseMethod('SetIdle');" type="button" value="置闲"  title="执行方法:SetIdle()">
			    <input id="btnSetWrapUp" onclick="funBaseMethod('SetWrapUp');" type="button" value="置后续态"  title="执行方法:SetWrapUp()">
			    <input id="btnSetCTICalloutTask" onclick="funBaseMethod('SetCTICalloutTask');" type="button" value="设置外呼任务"  title="执行:SetCTICalloutTask(DestNum.value);">
			    <input id="btnGetCTICalloutTask" onclick="funBaseMethod('GetCTICalloutTask');" type="button" value="得到外呼任务号"  title="执行:GetCTICalloutTask();">
			    <input id="btnGetCallData" onclick="funBaseMethod('GetCallData');" type="button" value="得到随路数据"  title="执行:GetCallData(DestNum.value);">
			    <input id="btnSetCallData" onclick="funBaseMethod('SetCallData');" type="button" value="设置随路数据"  title="执行:SetCallData(DestNum.value,DestNum2.value);">
			    <input id="btnChangeCallQueue" onclick="funBaseMethod('ChangeCallQueue');//application.oJVccBar.ChangeCallQueue(DestNum.value,DestNum2.value,'000');" type="button" value="ChangeCallQueue"   title="执行:ChangeCallQueue(DestNum.value,DestNum2.value,'000');">
				<br>
			    <input id="btnGetCallID" onclick="alert(application.oJVccBar.GetCallID());" type="button" value="得到CallID"  title="执行:GetCallID();">
 				<input id="btnQuerySPGroupList" onclick="funBaseMethod('QuerySPGroupList');//application.oJVccBar.QuerySPGroupList(DestNum.value,2,parseInt(DestNum2.value),1,2,0);" type="button" value="QuerySPGroupList"  title="执行:QuerySPGroupList(DestNum.value,-1,parseInt(DestNum2.value),1);">
				<input id="btnQuerySPGroupList1" onclick="funBaseMethod('QuerySPGroupList1');//application.oJVccBar.QuerySPGroupList(DestNum.value,-1,parseInt(DestNum2.value),1,0,5);" type="button" value="QuerySPGroupList Begin"  title="执行:QuerySPGroupList(DestNum.value,-1,parseInt(DestNum2.value),1,2,5);">
				<input id="btnQuerySPGroupList2" onclick="funBaseMethod('QuerySPGroupList2');//application.oJVccBar.QuerySPGroupList(DestNum.value,-1,parseInt(DestNum2.value),1,1,0);" type="button" value="QuerySPGroupList End"  title="执行:QuerySPGroupList(DestNum.value,-1,parseInt(DestNum2.value),1,1,0);">
			    <input id="btnGetCallInfo" onclick="alert(application.oJVccBar.GetCallInfo());" type="button" value="得到呼叫信息"  title="执行:GetCallInfo();">
			    <input id="btnSetTransparentParameter" onclick="funBaseMethod('SetTransparentParameter');" type="button" value="设置透明参数"  title="执行:SetTransparentParameter(DestNum.value);">
				<br>
				<input id="btnGetAgentStatus" onclick="alert(application.oJVccBar.GetAgentStatus());" type="button" value="得到座席状态"   title="执行:GetAgentStatus();">
				<input id="btnGetBusySubStatus" onclick="alert(application.oJVccBar.GetBusySubStatus());" type="button" value="得到忙碌子状态信息"   title="执行:GetBusySubStatus();">
			    <input id="btnSetDisplayNumber" onclick="funBaseMethod('SetDisplayNumber');" type="button" value="设置外呼显示号码"  title="执行:SetDisplayNumber(DestNum.value);">
			    <input id="btnGetDisplayNumber" onclick="funBaseMethod('GetDisplayNumber');" type="button" value="得到外呼显示号码"  title="执行:GetDisplayNumber();">
		</div>	
	    <div id ="divPad7" style="position:absolute;border:0px solid #ff00ff;left:287px;top:70px; display:none;"  >
			   <br>
			   <input id="btnCallQueueQuery" onclick="funBaseMethod('CallQueueQuery');" type="button" value="查询排队信息"   title="执行:CallQueueQuery(DestNum.value);" >
			   <input id="btnCallQueueQuery1" onclick="funBaseMethod('CallQueueQuery1');" type="button" value="查询排队信息(开始)"   title="执行:CallQueueQuery(DestNum.value,2,5);" >
			   <input id="btnCallQueueQuery2" onclick="funBaseMethod('CallQueueQuery2');" type="button" value="查询排队信息(结束)"   title="执行:CallQueueQuery(DestNum.value,1,0);" >
			   <input id="btnQueryGroupAgentStatus" onclick="funBaseMethod('QueryGroupAgentStatus');" type="button" value="查询指定组的座席状态"  title="执行:QueryGroupAgentStatus(DestNum.value,parseInt(DestNum2.value),10);">
			   <br>
			   <input id="btnQueryGroupAgentStatus2" onclick="funBaseMethod('QueryGroupAgentStatus1');" type="button" value="查询指定组的座席状态2"  title="执行:QueryGroupAgentStatus(DestNum.value,parseInt(DestNum2.value),10,1);">
			   <input id="btnGetBase64Data" onclick="alert(application.oJVccBar.GetBase64Data(DestNum.value));" type="button" value="base64编码"  title="执行:GetBase64Data(DestNum.value);">
			   <input id="btnGetDataFromBase64" onclick="alert(application.oJVccBar.GetDataFromBase64(DestNum.value));" type="button" value="反base64编码"  title="执行:GetDataFromBase64(DestNum.value);">
			   <input id="btnSetWeChatQueueFlag" onclick="funBaseMethod('SetWeChatQueueFlag');" type="button" value="设置微信参与排队"  title="执行:SetWeChatQueueFlag(parseInt(DestNum.value));">
			   <input id="btnGetWeChatQueueFlag" onclick="funBaseMethod('GetWeChatQueueFlag');" type="button" value="得到微信参与排队"  title="执行:GetWeChatQueueFlag();">
			   <br>
			   <input id="btnTransferCallQueue" onclick="funBaseMethod('TransferCallQueue');" type="button" value="转接排队用户"   title="执行:TransferCallQueue(DestNum.value,0,DestNum2.value);">
			   <input id="btnSetActiveService" onclick="funBaseMethod('SetActiveService');" type="button" value="设置当前人工服务"  title="执行:SetActiveService(DestNum.value);">
			   <input id="btnGetActiveService" onclick="funBaseMethod('GetActiveService');" type="button" value="当前座席人工服务集合"  title="执行:GetActiveService();">
			   <input id="btnSetForwardNumber" onclick="funBaseMethod('SetForwardNumber');" type="button" value="设置接续号码"  title="执行:SetForwardNumber(DestNum.value,parseInt(DestNum2.value));">
			   <input id="btnGetForwardNumber" onclick="funBaseMethod('GetForwardNumber');" type="button" value="得到接续号码"  title="执行:GetForwardNumber();">
			   <input id="btnSetAgentReservedStatus" onclick="funBaseMethod('SetAgentReservedStatus');" type="button" value="设置坐席预留状态"  title="执行:SetAgentReservedStatus(parseInt(DestNum.value),parseInt(DestNum2.value));">
			   <input id="btnGetAgentLogFile" onclick="funBaseMethod('GetAgentLogFile');" type="button" value="得到外网座席日志"  title="执行: GetAgentLogFile(DestNum.value,DestNum2.value);" >
				<br>
				<input id="btnSetMMService" onclick="funBaseMethod('SetMMService');" type="button" value="设置多媒体服务"  title="执行: SetMMService(DestNum.value,parseInt(DestNum2.value));" >
				<input id="btnDeleteCaptureFile" onclick="funBaseMethod('DeleteCaptureFile');" type="button" value="删除截图文件"  title="执行:DeleteCaptureFile(DestNum.value);">
		</div>
	    <div id ="divPad3" style="position:absolute;border:0px solid #ff00ff;left:287px;top:70px; display:none;"  >
                <br>
				<input id="btnMakeCall" onclick="funCallMethod('MakeCall');" type="button" value="外呼" title="执行:MakeCall(DestNum.value,2,'',DestNum2.value,'');" >
			    <input id="btnMakeCall2" onclick="funCallMethod('MakeCall1');" type="button" value="加密外呼" title="执行:MakeCall(DestNum.value,2,'',DestNum2.value,'');" >
			    <input id="btnMakeCall3" onclick="funCallMethod('MakeCall2');" type="button" value="av外呼" title="执行:MakeCall(DestNum.value,2,'',DestNum2.value,'');" >
				<input id="btnCallIn" onclick="funCallMethod('CallIn');" type="button" value="内呼" title="执行方法:CallIn(DestNum.value,5,DestNum2.value);" >
				<input id="btnTransferOut" onclick="funCallMethod('TransferOut');" type="button" value="转出"  title="执行:TransferOut(parseInt(DestNum2.value),DestNum.value)" >
				<input id="btnHold" onclick="funCallMethod('Hold');" type="button" value="保持" title="执行:Hold(DestNum.value);" >
				<input id="btnRetrieveHold" onclick="funCallMethod('RetrieveHold');" type="button" value="取保持"   title="执行:RetrieveHold(DestNum.value);" >
				<input id="btnDisconnect" onclick="funCallMethod('Disconnect');" type="button" value="挂断"   title="执行:Disconnect(parseInt(DestNum.value));" >
				<input id="btnAnswer" onclick="funCallMethod('Answer');" type="button" value="应答"   title="执行:Answer(parseInt(DestNum.value));" >
				<input id="btnConsult" onclick="funCallMethod('Consult');" type="button" value="咨询"   title="执行:Consult(parseInt(DestNum2.value),DestNum.value);" >
				<input id="btnTransfer" onclick="funCallMethod('Transfer');" type="button" value="转移"   title="执行:Transfer();" >
				<input id="btnConference" onclick="funCallMethod('Conference');" type="button" value="会议"   title="执行:Conference();" >
                <br>
				<input id="btnSendDTMF" onclick="funCallMethod('SendDTMF');" type="button" value="二次拨号" title="执行方法:SendDTMF(DestNum.value);" >
				<input id="btnBeginPlay" onclick="funCallMethod('BeginPlay');" type="button" value="推送视频"  title="执行:BeginPlay(DestNum.value,'',2,'message.wav','1');"  >
				<input id="btnStopPlay" onclick="funCallMethod('StopPlay');" type="button" value="停止推送"  title="执行:StopPlay(DestNum.value,'');"  >
				<input id="btnBridge" onclick="funCallMethod('Bridge');" type="button" value="桥接"  title="执行:Bridge(DestNum.value,parseInt(DestNum2.value));"  >
				<input id="btnMute" onclick="funCallMethod('Mute');" type="button" value="静音"   title="执行:Mute(parseInt(DestNum.value));" >
				<input id="btnCallBack" onclick="application.oJVccBar.CallBack();" type="button" value="回拨" title="执行:CallBack();" >
				<input id="btnReCall" onclick="application.oJVccBar.ReCall();" type="button" value="重拨"   title="执行:ReCall();" >
				<input id="btnReleaseThirdOne" onclick="funCallMethod('ReleaseThirdOne');" type="button" value="挂断第三方"   title="执行:ReleaseThirdOne(parseInt(DestNum.value));" >
				<br>
				<INPUT id="btnBeginCollect" onclick="funCallMethod('BeginCollect');" type="button" value="开始收号" title="执行:BeginCollect(DestNum.value,DestNum2.value,0,'',1,1,'','',20,10);" >
				<INPUT id="btnStopCollect" onclick="funCallMethod('StopCollect');" type="button" value="停止收号"  title="执行:StopCollect(DestNum.value,DestNum2.value);" >
				<input id="btnFroceReset" onclick="application.oJVccBar.ForceReset();" type="button" value="强复位"  title="执行方法:FroceReset()">
				<input id="btnSendIMMessage" onclick="funCallMethod('SendIMMessage');" type="button" value="发送即时消息"  title="执行方法:SendIMMessage( '','','',1,0,DestNum.value);">
			    <input id="btnSendSipSessionMessage" onclick="funSendSipMessage('1');" type="button" value="发送sip文本消息"  title="执行方法:(1);">
				<input id="btnSendSipSessionMessage2" onclick="funSendSipMessage('0');" type="button" value="发送sip图片消息"  title="执行方法:funSendSipMessage(0);">
				<br>
			    <input id="btnUpdateMedia" onclick="funCallMethod('UpdateMedia');" type="button" value="UpdateMedia"  title="执行方法:UpdateMedia(DestNum.value,DestNum2.value);">
			    <input id="btnBeginCapture" onclick="funCallMethod('BeginCapture');" type="button" value="BeginCapture"  title="执行方法:BeginCapture(DestNum.value,DestNum2.value);">
                <input id="btnConnect" onclick="funCallMethod('Connect');" type="button" value="Connect"  title="执行方法:Connect(DestNum.value);">
    			<input id="btnReleaseConnectOne" onclick="funCallMethod('ReleaseConnectOne');" type="button" value="ReleaseConnectOne"  title="执行方法:Connect(DestNum.value);">
	    		<input id="btnMultiConfTransfer" onclick="funCallMethod('MultiConfTransfer');" type="button" value="MultiConfTransfer"  title="执行方法:Connect(DestNum.value);">
			    <input id="btnModifyVideoStream" onclick="funCallMethod('ModifyVideoStream');" type="button" value="ModifyVideoStream"  title="执行方法:ModifyVideoStream(DestNum.value,0,DestNum2.value);">
		</div>
	    <div id ="divPad4" style="position:absolute;border:0px solid #ff00ff;left:287px;top:70px; display:none;"  >
                <br>
 				<input id="btnForceClear" onclick="funListenMethod('ForeReleaseCall');" type="button" value="强拆"  title="执行方法:ForeReleaseCall(DestNum.value)" >
				<input id="btnInsert" onclick="funListenMethod('Insert');" type="button" value="强插" title="执行方法:Insert(DestNum.value)" >
				<input id="btnListen" onclick="funListenMethod('Listen');" type="button" value="监听" title="执行方法:Listen(DestNum.value)" >
				<input id="btnIntercept" onclick="funListenMethod('Intercept');" type="button" value="拦截" title="执行方法:Intercept(DestNum.value)" >
    			<input id="btnInterceptUser" onclick="funListenMethod('InterceptUser');" type="button" value="拦截用户" title="执行方法:Intercept(DestNum.value,1,'',1)" >
				<input id="btnHelp" onclick="funListenMethod('Help');" type="button" value="辅助"  title="执行方法:Help(DestNum.value)" >
                <br>
				<input id="btnForceIdle" onclick="funListenMethod('ForceIdle');" type="button" value="强制置闲" title="执行方法:ForceIdle(DestNum.value)">
				<input id="btnForceBusy" onclick="funListenMethod('ForceBusy');" type="button" value="强制置忙"  title="执行方法:ForceBusy(DestNum.value)">
				<input id="btnForceOut" onclick="funListenMethod('ForceOut');" type="button" value="强制签出"  title="执行方法:ForceOut(DestNum.value)">
				<input id="btnLock" onclick="funListenMethod('Lock');" type="button" value="锁定"  title="执行方法:Lock(DestNum.value);【不用，系统自己锁定】">
				<input id="btnUnLock" onclick="funListenMethod('UnLock');" type="button" value="解锁"  title="执行方法:UnLock(DestNum.value)">
		</div>	
	    <div id ="divPad5" style="position:absolute;border:0px solid #ff00ff;left:287px;top:70px; display:none;"  >
                <br>
 				<input id="btnInitialState" onclick="funMonitorMethod('InitialState');" type="button" value="InitialState"  title="执行方法:InitialState();" >
				<input id="btnAgentQuery" onclick="funMonitorMethod('AgentQuery');" type="button" value="AgentQuery"  title="执行方法:AgentQuery(DestNum.value,parseInt(DestNum2.value));" >
				<input id="btnTelQuery" onclick="funMonitorMethod('TelQuery');" type="button"  value="TelQuery" title="执行方法:TelQuery(DestNum.value,parseInt(DestNum2.value));" >
				<input id="btnIvrQuery" onclick="funMonitorMethod('IvrQuery');" type="button"  value="IvrQuery" title="执行方法:IvrQuery(DestNum.value,parseInt(DestNum2.value));" >
				<input id="btnServiceQuery" onclick="funMonitorMethod('ServiceQuery');" type="button"  value="ServiceQuery" title="执行方法:ServiceQuery(DestNum.value,parseInt(DestNum2.value));" >
                <br>
				<input id="btnTaskQuery" onclick="funMonitorMethod('TaskQuery');" type="button"  value="TaskQuery" title="执行方法:TaskQuery(DestNum.value,parseInt(DestNum2.value));" >
				<input id="btnCallReportQuery" onclick="funMonitorMethod('CallReportQuery');" type="button"  value="CallReportQuery" title="执行方法:CallReportQuery(DestNum.value,parseInt(DestNum2.value));" >
				<input id="btnGetTaskSummary" onclick="funMonitorMethod('GetTaskSummary');" type="button"  value="GetTaskSummary" title="执行方法:GetTaskSummary(DestNum.value,DestNum2.value);" >
                <br>
				<input id="btnQueryMonitorSumInfo" onclick="funMonitorMethod('QueryMonitorSumInfo');" type="button" value="查询指定参数的统计信息" title="执行:QueryMonitorSumInfo(DestNum.value,DestNum2.value);" >
				<input id="btnStartNotification" onclick="funMonitorMethod('StartNotification');" type="button" value="StartNotification"  title="执行方法:StartNotification(DestNum.value,DestNum2.value,'');" >
				<input id="btnEndNotification" onclick="funMonitorMethod('EndNotification');" type="button" value="EndNotification" title="执行方法:EndNotification(DestNum.value);" >
	            <br>
		</div>	

		<div class="divframe" id="divVedioDlg" style="position:absolute;top:60px;left:950px;width:460px;height:370px;background:#CCE6FF;color:#333;z-index: 999; display: none;">
			<div id="divVedioWindow" class="divStatus" style="margin-left:2px;margin-top:2px;padding-top: 10px;width:460px;height:357px;background:#99cdff;color:#333;" >
				&nbsp;&nbsp;&nbsp;视频窗口:
				<!--
				<div style="display:inline-block; ">
					<span id="Vdelay" class="color0"> 延时：0ms </span>
				</div>
				<div style="position:absolute;border:0px solid #ff00ff;left:200px; top:8px">
					<ul id="VQuality"><li></li><li></li><li></li><li></li><li></li></ul>
				</div>
				-->
				<div style="position:absolute;border:0px solid #ff00ff;left:440px; top:8px">
					<img src="jquery-easyui-1.4\themes\icons\cancel.png"  onclick="DisplayDiv('divVedioDlg',0);" />
				</div>
				<div id="agent_webcam" style="cursor: move; position: relative; border: 2px solid rgb(70, 163, 255); border-radius: 10px; left: 10px; top: 5px; width: 430px; height: 300px; background: rgb(130, 130, 130); display: block;">
					<div id="agent_remoteView" style="width:430px; height: 300px;background-color: transparent;" ></div>
					<div id="agent_shareView" style="position:absolute;left:150px;bottom: 6px;width: 133px;height: 100px;background-color: #aaaaaa;border-top: 2px solid #aaaaaa;border-right: 2px solid #aaaaaa;display:none" ></div>
					<div id="agent_selfView" style="position:absolute;left:8px;bottom: 6px;width: 100px;height: 133px;background-color: #aaaaaa;border-top: 2px solid #aaaaaa;border-right: 2px solid #aaaaaa;" ></div>
				</div>
				<div style="position: relative;left: 12px; top: 10px;  " >
					<input id="btnShareScreen" onclick="shareSreen('screen');" type="button" value="屏幕共享" >
					<input id="btnShareImage" onclick="shareSreen('background');" type="button" value="图片1" >
					<input id="btnShareImage2" onclick="shareSreen('background',2);" type="button" value="图片2" >
					<input id="btnShareFile" onclick="shareSreen('videoFile');" type="button" value="文件共享" >
					<input id="btnSharecamera" onclick="shareSreen('camera');" type="button" value="摄像头" >
					<input id="btnSharecanvas" onclick="shareSreen('stream');" type="button" value="canvas" >
					<input id="btnSnapShot" onclick="SnapShot();" type="button" value="远程快照" >
				</div>
			</div>
		</div>
        <DIV id ="divMessage0"  style='position:absolute;border:0px solid #00ff00; left:287px;top:226px;'>
		<TEXTAREA id="TextareaInfo" name="TextareaInfo" rows="32" cols="150" value="" spellcheck="false" style="overflow:auto;font-family:verdana;font-size:12px"></TEXTAREA>
		</DIV>
		<div class="divframe" id="divPicDlg" style="position:absolute;top:280px;left:425px;width:424px;height:345px;background:#CCE6FF;color:#333;display: none">
			<div style="position:absolute;border:0px solid #ff00ff;left:400px; top:4px">
				<img src="jquery-easyui-1.4\themes\icons\cancel.png"  onclick="DisplayDiv('divPicDlg',0);" />
			</div>
			<div style="position:absolute;border:0px solid #ff00ff;top:30px;left:4px;width:414px;height:310px;">
				<img  id="recvPic" src="" style="position:absolute;border:0px solid #ff00ff;top:0px;left:0px;width:414px;height:310px;" />
			</div>
		</div>

		<video id="local_file" style="position:absolute;left:980px;bottom: 106px;width: 300px;height: 200px;background-color: #aaaaaa;border-top: 2px solid #aaaaaa;border-right: 2px solid #aaaaaa; display: none" autoplay playsinline controls muted  loop="loop" >
			<source id = "srcfile" src="scripts/sip/videos/cat.mp4" type="video/mp4" />
		</video>

		<canvas id="canvas" style="position:absolute;left:568px;top: 200px;width: 300px;height: 300px; display: none">
			Does not support canvas;
		</canvas>
</body>
   <script type="text/javascript">
    var g_showIndex = 1;
	var clickX;
	var clickY;
    function funChangePad(index){
        var oPad = document.getElementById("divPad"+g_showIndex);
        oPad.style.display = "none";
        
        var oBtn = document.getElementById("btncmd"+g_showIndex);
        oBtn.style.background = "#f5f9ff";
        
        oPad = document.getElementById("divPad"+index);
        oPad.style.display = "block";
        oBtn = document.getElementById("btncmd"+index);
        oBtn.style.background = "#80BEC4";
        
        g_showIndex = index;
    }

    function funInitial() {
	    var  serverIP = document.getElementById("mainIP").value;
	    var  vccID    = document.getElementById("vccID").value;
	    var  agentID  = document.getElementById("agentID").value;
		var  sipPassword = document.getElementById("sipPassword").value;
		var  mainPort    = document.getElementById("mainPort").value;

        application.oJVccBar.SetAttribute("MainIP",serverIP);
		application.oJVccBar.SetAttribute("MainPortID",mainPort);
        application.oJVccBar.SetAttribute("BackIP",serverIP);
        application.oJVccBar.SetAttribute("MonitorIP",serverIP);
 		application.oJVccBar.SetAttribute("MonitorPort",mainPort);
        application.oJVccBar.SetAttribute("SipServerIP",serverIP);
        application.oJVccBar.SetAttribute("SipServerPort",mainPort);
        application.oJVccBar.SetAttribute("SipProtocol","wss");
        application.oJVccBar.SetAttribute("MediaFlag",vccID);
        application.oJVccBar.SetAttribute("PassWord",agnetPassword.value);
        application.oJVccBar.SetAttribute("AgentID","000010"+vccID+agentID);
        application.oJVccBar.SetAttribute("Dn","000002"+vccID+agentID);
        application.oJVccBar.SetAttribute("SipXPath", sipXPath.value);
        application.oJVccBar.SetAttribute("SipPassWord", sipPassword);
		application.oJVccBar.SetAttribute("AppType",parseInt(oAppType.options[oAppType.options.selectedIndex].value));
		application.oJVccBar.SetAttribute("ProtocolType",parseInt(oProtocolType.options[oProtocolType.options.selectedIndex].value));
        application.oJVccBar.SetAttribute('TransportType',parseInt(oTransportType.options[oTransportType.options.selectedIndex].value));

        application.oJVccBar.SetAttribute('ForeCastCallAutoAnswer',1); //
		application.oJVccBar.SetAttribute("AutoAnswerDelayTime", 0);

        application.oJBarDisplayer = appVccBar;

        funSerialBtn("0,1,2,3,4,5,6,7,8,9,10,11,12,13,15,16,19,20,21,22,23,24,27,31","19,20,21,22,23,24,27,31");

        funConfigurate();

		application.oJVccBar.Initial()
	}

	function funSerialBtn(btnIDs,hideIDs){
	    if(typeof (btnIDs) == "undefined")
          btnIDs = DestNum.value;
		if(typeof (hideIDs) == "undefined")
			hideIDs = DestNum2.value;
		if(appVccBar != null){
            appVccBar.SerialBtn(btnIDs,hideIDs);
		}

		application.oJVccBar.SerialBtn(btnIDs,DestNum2.value);
	}

    function funSendSipMessage(msgType) {
       var msg = DestNum.value;
       msg= trimStr(msg);
       if(msg == "") return;
		application.oJVccBar.SendSipSessionMessage(msg);
    }

	function window_onload(){
	    if(document.readyState=="complete"){
	        funChangePad(1);
	        try {
                document.addEventListener("mousemove",function(e){clickX = e.clientX;clickY = e.clientY;});
			}
        	catch (ex){
                document.attachEvent("onmousemove",function(e){clickX = e.clientX;clickY = e.clientY;});
			}
			var  param = "服务器|企业号码|座席短号|端口号|分机密码|座席密码|sipXPath";

			param = "47.94.156.96|003721|1002|5049|HS1Cd?qF1686YE4aM|123abc|sbc";

	        var oParam = param.split("|");
	        mainIP.value = oParam[0];
	        vccID.value = oParam[1];
	        agentID.value = oParam[2];
	        mainPort.value = oParam[3];
            sipPassword.value = oParam[4];
            if(oParam.length>5)
                agnetPassword.value = oParam[5];
            if(oParam.length>6)
                sipXPath.value = oParam[6];
	    }
		//DisplayDiv("divVedioDlg",true);

	    applicationUILoad(10,10,1300,40,"");
        applicationLoad('',setVccBarOnEvent,"");

		GetMediaDevices(function(devices){
			for (var i = 0; i !== devices.length; ++i)
			{
				const deviceInfo = devices[i];
				const option = document.createElement('option');
				option.value = deviceInfo.deviceId;
				option.text = deviceInfo.label
				oCameraDevices.appendChild(option);
			}
		})
		GetAudioInputDevices(function(devices){
			for (var i = 0; i !== devices.length; ++i)
			{
				const deviceInfo = devices[i];
				const option = document.createElement('option');
				option.value = deviceInfo.deviceId;
				option.text = deviceInfo.label
				oAudioInputDevices.appendChild(option);
			}
		})
		GetAudioOutputDevices(function(devices){
			for (var i = 0; i !== devices.length; ++i)
			{
				const deviceInfo = devices[i];
				const option = document.createElement('option');
				option.value = deviceInfo.deviceId;
				option.text = deviceInfo.label
				oAudioOutputDevices.appendChild(option);
			}
		})
	}

	function funConfigurate() {
 		var options = {sip:{
				width: parseInt(resolutionWidth.value),
				height:parseInt(resolutionHeight.value),
				framerate:parseInt(resolutionFrame.value),
				bandwidth:parseInt(resolutionBandWidth.value),
				source:oVideoSource.options[oVideoSource.options.selectedIndex].value,
				videosource:"",
				audioinputdeviceid : (oAudioInputDevices.options.length>0)?oAudioInputDevices.options[oAudioInputDevices.options.selectedIndex].value:"",
				audiooutputdeviceid : (oAudioOutputDevices.options.length>0)?oAudioOutputDevices.options[oAudioOutputDevices.options.selectedIndex].value:""
			}};
		if(IsCheckBoxSelected("log_rtpStatics"))
			options.sip.getrtpstatics = true;

		if(options.sip.source == "camera"){
			//options.source = LocalVideoSrc.Camera;
			if(oCameraDevices.options.length>0){
				options.sip.videosource = oCameraDevices.options[oCameraDevices.options.selectedIndex].value;
			}
			//options.sip.videotext = {};
			options.sip.videotext = null;
		}
		else if(options.sip.source == "watermark"){
			//options.source = LocalVideoSrc.Camera;
			if(oCameraDevices.options.length>0){
				options.sip.videosource = oCameraDevices.options[oCameraDevices.options.selectedIndex].value;
			}
			options.sip.videotext = {
				text:{
					content:"座席标题",
					x:options.sip.width-20,
					y:100,
					color:"#000000"
				},
				timer:
						{
							flag:true,
							x:options.sip.width-20,
							y:options.sip.height-40
						},
				image:{
					url:"scripts/ui/images/agent.png",
					x:options.sip.width-80,
					y:10
				}
			};
		}
		else if(options.sip.source == "background"){
			//options.source = LocalVideoSrc.BackGround;
			options.sip.videosource = "scripts/ui/images/test.png";
			options.sip.videotext = {};
		}

		showLog(JSON.stringify(options)+"\n");
		application.oJVccBar.Configurate(options);

	}

	function _displayCallBackEvent(cmd,o){
		 var code = parseInt(o.data);
		 if(code>0){
			 showLog(cmd +" callback event data:["+o.data+"] des:["+application.oJVccBar.GetCodeDescription(code)+"]\r\n");
		 }
		 else{
			 showLog(cmd +" callback event data:["+o.data+"]\r\n");
		 }
	 }

	function funBaseMethod(cmd){
    	if(cmd == "SetBusy"){
			application.oJVccBar.SetBusy({subStatus:parseInt(DestNum.value),
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == "SetIdle"){
			application.oJVccBar.SetIdle({
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == "SetWrapUp"){
			application.oJVccBar.SetWrapUp({
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'SetCTICalloutTask') {
			application.oJVccBar.SetCTICalloutTask({tastNum:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'GetCTICalloutTask') {
			application.oJVccBar.GetCTICalloutTask({
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'GetCallData') {
			application.oJVccBar.GetCallData({destAgentID:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'SetCallData') {
			application.oJVccBar.SetCallData({destAgentID:DestNum.value,
				calldata:DestNum2.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'ChangeCallQueue') {
			application.oJVccBar.ChangeCallQueue({calling:DestNum.value,
				queuekey:DestNum2.value,
				orderid:'000',
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'QuerySPGroupList') {
			application.oJVccBar.QuerySPGroupList({groupID:DestNum.value,
				agentStatus:2,
				cmdType:parseInt(DestNum2.value),
				checkAuthor:1,action:2,interval:0,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'QuerySPGroupList1') {
			application.oJVccBar.QuerySPGroupList({groupID:DestNum.value,
				agentStatus:-1,
				cmdType:parseInt(DestNum2.value),
				checkAuthor:1,action:0,interval:5,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'QuerySPGroupList2') {
			application.oJVccBar.QuerySPGroupList({groupID:DestNum.value,
				agentStatus:-1,
				cmdType:parseInt(DestNum2.value),
				checkAuthor:1,action:1,interval:5,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'SetTransparentParameter') {
			application.oJVccBar.SetTransparentParameter({transparentParam:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'SetDisplayNumber') {
			application.oJVccBar.SetDisplayNumber({destNum:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'GetDisplayNumber') {
			application.oJVccBar.GetDisplayNumber({
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'CallQueueQuery') {
			application.oJVccBar.CallQueueQuery({serviceID:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'CallQueueQuery1') {
			application.oJVccBar.CallQueueQuery({serviceID:DestNum.value,
				action:0,
				interval:5,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'CallQueueQuery2') {
			application.oJVccBar.CallQueueQuery({serviceID:DestNum.value,
				action:1,
				interval:0,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'QueryGroupAgentStatus') {
			application.oJVccBar.QueryGroupAgentStatus({groupIDs:DestNum.value,
				action:parseInt(DestNum2.value),
				interval:10,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'QueryGroupAgentStatus1') {
			application.oJVccBar.QueryGroupAgentStatus({groupIDs:DestNum.value,
				action:parseInt(DestNum2.value),
				interval:10,
				type:1,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'SetWeChatQueueFlag') {
			application.oJVccBar.SetWeChatQueueFlag({flag:parseInt(DestNum.value),
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'GetWeChatQueueFlag') {
			application.oJVccBar.GetWeChatQueueFlag({
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'TransferCallQueue'){
			application.oJVccBar.TransferCallQueue({queuekey:DestNum.value,
				transferType:0,
				destNum:parseInt(DestNum2.value),
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'SetActiveService') {
			application.oJVccBar.SetActiveService({serviceNum:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'GetActiveService') {
			application.oJVccBar.GetActiveService({
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'SetForwardNumber') {
			application.oJVccBar.SetForwardNumber({num:DestNum.value,
				state:parseInt(DestNum2.value),
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'GetForwardNumber') {
			application.oJVccBar.GetForwardNumber({
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'SetAgentReservedStatus') {
			application.oJVccBar.SetAgentReservedStatus({agentStatus:parseInt(DestNum.value),
				subBusyStatus:parseInt(DestNum2.value),
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'SetMMService') {
			application.oJVccBar.SetMMService({serviceID:DestNum.value,
				flag:parseInt(DestNum2.value),
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == "DeleteCaptureFile"){
			application.oJVccBar.DeleteCaptureFile({fileName:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
    }

    function funCallMethod(cmd){
		if(cmd == 'MakeCall'){
			application.oJVccBar.MakeCall({destNum:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'MakeCall1'){
			application.oJVccBar.MakeCall({destNum:DestNum.value,
				cryptType:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'MakeCall2'){
			application.oJVccBar.MakeCall({destNum:DestNum.value,
				av:2,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'CallIn'){
			application.oJVccBar.CallIn({destAgentID:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'TransferOut'){
			application.oJVccBar.TransferOut({transferType:parseInt(DestNum.value),
				destNum:DestNum2.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'Hold'){
			application.oJVccBar.Hold({
				destDeviceID:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'RetrieveHold'){
			application.oJVccBar.RetrieveHold({
				destDeviceID:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'Disconnect'){
			application.oJVccBar.Disconnect({callType:parseInt(DestNum.value),
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'Answer'){
			application.oJVccBar.Answer({recordFlag:parseInt(DestNum.value),
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'Consult'){
			application.oJVccBar.Consult({consultType:parseInt(DestNum.value),
				consultNum:DestNum2.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'Transfer'){
			application.oJVccBar.Transfer({
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'Conference'){
			application.oJVccBar.Conference({
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'Conference'){
			application.oJVccBar.Conference({
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'SendDTMF'){
			application.oJVccBar.SendDTMF({tapKey:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'BeginPlay'){
			application.oJVccBar.BeginPlay({destAgentID:DestNum.value,
				destDeviceID:'',
				paType:0,
				fileName:DestNum2.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'StopPlay'){
			application.oJVccBar.BeginPlay({destAgentID:DestNum.value,
				destDeviceID:'',
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'Bridge'){
			application.oJVccBar.Bridge({ivrNum:DestNum.value,
				endCall:parseInt(DestNum2.value),
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'Mute'){
			application.oJVccBar.Mute({flag:parseInt(DestNum.value),
				destDeviceID:DestNum2.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'ReleaseThirdOne'){
			application.oJVccBar.ReleaseThirdOne({retrieveCall:parseInt(DestNum.value),
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'BeginCollect'){
			application.oJVccBar.BeginCollect({destAgentID:DestNum.value,
				destDeviceID:'',
				playType:0,fileName:DestNum2.value,
				min:1,max:10,end:'#',
				cel:'*',fto:5,ito:3,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'StopCollect'){
			application.oJVccBar.StopCollect({destAgentID:DestNum.value,
				destDeviceID:'',
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'SendIMMessage'){
			application.oJVccBar.SendIMMessage({destTarget0:DestNum.value,
				destTarget1:'',
				destTarget2:'',
				logicOperator:0,
				msgtype:0,
				message:DestNum2.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'UpdateMedia'){
			application.oJVccBar.UpdateMedia({destDeviceID:DestNum.value,
				av:DestNum2.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'BeginCapture'){
			application.oJVccBar.BeginCapture({destNum:DestNum.value,
				faceDet:1,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'Connect'){
			application.oJVccBar.Connect({destDeviceID:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'ReleaseConnectOne'){
			application.oJVccBar.ReleaseConnectOne({destDeviceID:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'MultiConfTransfer'){
			application.oJVccBar.MultiConfTransfer({destDeviceID:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'ModifyVideoStream'){
			application.oJVccBar.ModifyVideoStream({mode:parseInt(DestNum.value),
				line:'',
				display:DestNum2.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
	}

	function funListenMethod(cmd){
		if(cmd == 'ForeReleaseCall'){
			application.oJVccBar.ForeReleaseCall({destAgentID:DestNum.value,
				type:0,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'Insert'){
			application.oJVccBar.Insert({destAgentID:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'Listen'){
			application.oJVccBar.Listen({destAgentID:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'Intercept'){
			application.oJVccBar.Intercept({destAgentID:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'InterceptUser'){
			application.oJVccBar.Intercept({destAgentID:DestNum.value,
				type:1,
				direction:1,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'Lock'){
			application.oJVccBar.Lock({destAgentID:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'UnLock'){
			application.oJVccBar.UnLock({destAgentID:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'ForceIdle'){
			application.oJVccBar.ForceIdle({destAgentID:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'ForceBusy'){
			application.oJVccBar.ForceBusy({destAgentID:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'ForceOut'){
			application.oJVccBar.ForceOut({destAgentID:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'Help'){
			application.oJVccBar.Help({destAgentID:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
	}

	function funMonitorMethod(cmd){
		if(cmd == 'InitialState'){
			application.oJVccBar.InitialState({curPos:0,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'AgentQuery'){
			application.oJVccBar.AgentQuery({monitorid:DestNum.value,
				curPos:0,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'TelQuery'){
			application.oJVccBar.TelQuery({monitorid:DestNum.value,
				curPos:0,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'IvrQuery'){
			application.oJVccBar.IvrQuery({monitorid:DestNum.value,
				curPos:0,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'ServiceQuery'){
			application.oJVccBar.ServiceQuery({monitorid:DestNum.value,
				curPos:0,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'TaskQuery'){
			application.oJVccBar.TaskQuery({monitorid:DestNum.value,
				curPos:0,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'CallReportQuery'){
			application.oJVccBar.CallReportQuery({monitorid:DestNum.value,
				curPos:0,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'GetTaskSummary'){
			application.oJVccBar.GetTaskSummary({monitorid:DestNum.value,
				taskid:DestNum2.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'QueryMonitorSumInfo'){
			application.oJVccBar.QueryMonitorSumInfo({cmdName:DestNum.value,
				cmdParam:DestNum2.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'TrunkQuery'){
			application.oJVccBar.TrunkQuery({monitorid:DestNum.value,
				curPos:0,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'MMServiceQuery'){
			application.oJVccBar.MMServiceQuery({monitorid:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'StartNotification'){
			application.oJVccBar.StartNotification({id:DestNum.value,
				type:parseInt(DestNum2.value),
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
		else if(cmd == 'EndNotification'){
			application.oJVccBar.EndNotification({id:DestNum.value,
				callback:function(data){_displayCallBackEvent(cmd,data);}
			});
		}
	}

	function checknewhttpsUrl(server,port) {
		var  server = document.getElementById("mainIP").value;
		var  port    = document.getElementById("mainPort").value;
		var URL = "https://"+server+":"+port+"/JVccBar3/simple-all.html";
		window.open (URL);
	}

	function openPaletteWrapper () {
         console.info('open', $)
         $('#paletteWrapper').window('open')
         window.open('./dist/index.html', 'paletteIFrame')
    }

    </script>

</html>

